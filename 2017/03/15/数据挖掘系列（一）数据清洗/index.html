<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>数据挖掘系列（一）数据清洗 | Hello,Huimm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="想写这个系列很久了，最近刚好项目结束了闲下来有点时间，于是决定把之前学过的东西做个总结。之前看过一些机器学习方面的书，每本书都各有侧重点，机器学习实战和集体智慧编程更偏向与实战，侧重于对每个算法的实际操作过程，但是没有对整个数据挖掘项目做介绍，李航老师的统计学习方法和周志华老师的机器学习这两本书侧重对原理的讲解和公式的推导，但是实战方面可能会少一点。我结合之前看过的书，以及自己的一些项目经验做了">
<meta property="og:type" content="article">
<meta property="og:title" content="数据挖掘系列（一）数据清洗">
<meta property="og:url" content="http://blog.huimm.top/2017/03/15/数据挖掘系列（一）数据清洗/index.html">
<meta property="og:site_name" content="Hello,Huimm">
<meta property="og:description" content="想写这个系列很久了，最近刚好项目结束了闲下来有点时间，于是决定把之前学过的东西做个总结。之前看过一些机器学习方面的书，每本书都各有侧重点，机器学习实战和集体智慧编程更偏向与实战，侧重于对每个算法的实际操作过程，但是没有对整个数据挖掘项目做介绍，李航老师的统计学习方法和周志华老师的机器学习这两本书侧重对原理的讲解和公式的推导，但是实战方面可能会少一点。我结合之前看过的书，以及自己的一些项目经验做了">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/325148-434ee7b1af45819d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/325148-b3594976d85426b4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/325148-1f0ac1838dd1ea5d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-03-15T03:05:06.495Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="数据挖掘系列（一）数据清洗">
<meta name="twitter:description" content="想写这个系列很久了，最近刚好项目结束了闲下来有点时间，于是决定把之前学过的东西做个总结。之前看过一些机器学习方面的书，每本书都各有侧重点，机器学习实战和集体智慧编程更偏向与实战，侧重于对每个算法的实际操作过程，但是没有对整个数据挖掘项目做介绍，李航老师的统计学习方法和周志华老师的机器学习这两本书侧重对原理的讲解和公式的推导，但是实战方面可能会少一点。我结合之前看过的书，以及自己的一些项目经验做了">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/325148-434ee7b1af45819d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternative" href="/atom.xml" title="Hello,Huimm" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/logo.jpg">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/logo.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">Huimm</a></h1>
        </hgroup>

        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">首页</a></li>
                        
                            <li><a href="/archives">归档</a></li>
                        
                            <li><a href="/tags">标签</a></li>
                        
                            <li><a href="/love.html">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/huihui7987" title="github">github</a>
                            
                                <a class="fl zhihu" target="_blank" href="https://www.zhihu.com/people/huimm" title="zhihu">zhihu</a>
                            
                                <a class="fl weibo" target="_blank" href="#" title="weibo">weibo</a>
                            
                                <a class="fl google" target="_blank" href="#" title="google">google</a>
                            
                                <a class="fl twitter" target="_blank" href="#" title="twitter">twitter</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/data-mining-python/" style="font-size: 10px;">data-mining python</a> <a href="/tags/dataMining-python/" style="font-size: 10px;">dataMining,python</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/技术/" style="font-size: 10px;">技术</a> <a href="/tags/数据挖掘-python/" style="font-size: 10px;">数据挖掘 python</a> <a href="/tags/数据清洗/" style="font-size: 10px;">数据清洗</a>
                    </div>
                </section>
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">每一个不如意的现在，都有一个不够努力的曾经。</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Huimm</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/logo.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Huimm</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">首页</a></li>
                
                    <li><a href="/archives">归档</a></li>
                
                    <li><a href="/tags">标签</a></li>
                
                    <li><a href="/love.html">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/huihui7987" title="github">github</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/huimm" title="zhihu">zhihu</a>
                    
                        <a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
                    
                        <a class="google" target="_blank" href="#" title="google">google</a>
                    
                        <a class="twitter" target="_blank" href="#" title="twitter">twitter</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-数据挖掘系列（一）数据清洗" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/15/数据挖掘系列（一）数据清洗/" class="article-date">
      <time datetime="2017-03-15T02:34:59.000Z" itemprop="datePublished">2017-03-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      数据挖掘系列（一）数据清洗
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/数据挖掘/">数据挖掘</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据清洗/">数据清洗</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>　想写这个系列很久了，最近刚好项目结束了闲下来有点时间，于是决定把之前学过的东西做个总结。之前看过一些机器学习方面的书，每本书都各有侧重点，机器学习实战和集体智慧编程更偏向与实战，侧重于对每个算法的实际操作过程，但是没有对整个数据挖掘项目做介绍，李航老师的统计学习方法和周志华老师的机器学习这两本书侧重对原理的讲解和公式的推导，但是实战方面可能会少一点。我结合之前看过的书，以及自己的一些项目经验做了一些总结，一是回顾自己还有哪些遗漏，二是希望给新入门的同学一个参考。至于编程语言，主要用python，也会有少部分R，java和scala之类，毕竟实际项目中也不可能使用一种语言。此外，本系列所用到的所有数据我会传到Github上，需要的同学可以自行下载。为保证文章质量，每周二周四更新，下面是主要的目录（可能会根据实际情况调整）：</p>
<a id="more"></a>
<p>第一部分 模型的评估与数据处理<br>机器学习基础与实践（一）—-数据清洗<br>机器学习基础与实践（二）—-数据转换<br>机器学习基础与实践（三）—-数据降维</p>
<p>第二部分 特征工程<br>机器学习基础与实践（四）—-特征选择<br>机器学习基础与实践（五）—-特征提取<br>机器学习基础与实践（六）—-模型选择与评估</p>
<p>第三部分 算法基础之有监督算法<br>机器学习基础与实践（七）—-广义线性模型<br>机器学习基础与实践（八）—-最小二乘法<br>机器学习基础与实践（九）—-LDA<br>机器学习基础与实践（十）—-SGD<br>机器学习基础与实践（十一）—-K近邻<br>机器学习基础与实践（十二）—-高斯过程<br>机器学习基础与实践（十三）—-决策树（ID3，C4.5，C5.0，CART）<br>机器学习基础与实践（十四）—-朴素贝叶斯<br>机器学习基础与实践（十五）—-支持向量机<br>机器学习基础与实践（十六）—-集成学习（Bagging，RF，AdaBoost，Gradient Tree Boosting，Voting Classifier）<br>机器学习基础与实践（十七）—-感知机模型<br>机器学习基础与实践（十八）—-多分类算法</p>
<p>第四部分 算法基础之无监督算法<br>机器学习基础与实践（十九）—-K-means<br>机器学习基础与实践（二十）—-Affinity propagation<br>机器学习基础与实践（二十一）—-Mean-shift<br>机器学习基础与实践（二十二）—-Spectral clustering<br>机器学习基础与实践（二十三）—-Ward hierachical<br>机器学习基础与实践（二十四）—-Agglomerative clustering<br>机器学习基础与实践（二十五）—-DBSCAN<br>机器学习基础与实践（二十六）—-Gaussian mixtures<br>机器学习基础与实践（二十七）—-Birch</p>
<p>第五部分 算法基础之推荐算法<br>机器学习基础与实践（二十八）—-相似度计算<br>机器学习基础与实践（二十九）—-Arules关联规则<br>机器学习基础与实践（三十）—-Fp-Growth<br>机器学习基础与实践（三十一）—-User-based or Item-based</p>
<p>第六部分 算法基础之半监督模型<br>机器学习基础与实践（三十二）—-Label Propagation</p>
<p>第七部分 算法基础之其他模型<br> 机器学习基础与实践（三十三）—-概率图模型<br>机器学习基础与实践（三十四）—-最大熵模型<br>机器学习基础与实践（三十五）—-规则学习<br>机器学习基础与实践（三十六）—-强化学习<br>机器学习基础与实践（三十七）—-条件随机场<br>机器学习基础与实践（三十八）—-保序回归（Isotonic regression）<br>机器学习基础与实践（三十九）—-Probability calibration</p>
<p>正文：<br>　　按照我做项目的经验，来了项目，首先是分析项目的目的和需求，了解这个项目属于什么问题，要达到什么效果。然后提取数据，做基本的数据清洗。第三步是特征工程，这个属于脏活累活，需要耗费很大的精力，如果特征工程做的好，那么，后面选择什么算法其实差异不大，反之，不管选择什么算法，效果都不会有突破性的提高。第四步，是跑算法，通常情况下，我会把所有能跑的算法先跑一遍，看看效果，分析一下precesion/recall和f1-score，看看有没有什么异常（譬如有好几个算法precision特别好，但是recall特别低，这就要从数据中找原因，或者从算法中看是不是因为算法不适合这个数据），如果没有异常，那么就进行下一步，选择一两个跑的结果最好的算法进行调优。调优的方法很多，调整参数的话可以用网格搜索、随机搜索等，调整性能的话，可以根据具体的数据和场景进行具体分析。调优后再跑一边算法，看结果有没有提高，如果没有，找原因，数据 or 算法？是数据质量不好，还是特征问题还是算法问题。一个一个排查，找解决方法。特征问题就回到第三步再进行特征工程，数据质量问题就回到第一步看数据清洗有没有遗漏，异常值是否影响了算法的结果，算法问题就回到第四步，看算法流程中哪一步出了问题。如果实在不行，可以搜一下相关的论文，看看论文中有没有解决方法。这样反复来几遍，就可以出结果了，写技术文档和分析报告，再向业务人员或产品讲解我们做的东西，然后他们再提建议/该需求，不断循环，最后代码上线，改bug，直到结项。<br>　　直观来看，可以用一个流程图来表示：<br><img src="http://upload-images.jianshu.io/upload_images/325148-434ee7b1af45819d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>　　今天讲数据清洗，为什么要进行数据清洗呢？我们在书上看到的数据，譬如常见的iris数据集，房价数据，电影评分数据集等等，数据质量都很高，没有缺失值，没有异常点，也没有噪音，而在真实数据中，我们拿到的数据可能包含了大量的缺失值，可能包含大量的噪音，也可能因为人工录入错误导致有异常点存在，对我们挖据出有效信息造成了一定的困扰，所以我们需要通过一些方法，尽量提高数据的质量。数据清洗一般包括以下几个步骤：<br>一.分析数据<br>二.缺失值处理<br>三.异常值处理<br>四.去重处理<br>五.噪音数据处理<br>六.一些实用的数据处理小工具</p>
<p><strong>一.分析数据</strong><br>　　在实际项目中，当我们确定需求后就会去找相应的数据，拿到数据后，首先要对数据进行描述性统计分析，查看哪些数据是不合理的，也可以知道数据的基本情况。如果是销售额数据可以通过分析不同商品的销售总额、人均消费额、人均消费次数等，同一商品的不同时间的消费额、消费频次等等，了解数据的基本情况。此外可以通过作图的方式了解数据的质量，有无异常点，有无噪音等。举个例子（这里数据较少，就直接用R作图了）：<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> #一组年薪超过<span class="number">10</span>万元的经理收入</div><div class="line"><span class="number">2</span> pay=c(<span class="number">11</span>,<span class="number">19</span>,<span class="number">14</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">28</span>,<span class="number">13</span>,<span class="number">81</span>,<span class="number">12</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">16</span>,<span class="number">31</span>,<span class="number">16</span>,<span class="number">23.42</span>,<span class="number">22</span>,<span class="number">26</span>,<span class="number">17</span>,<span class="number">22</span>,<span class="number">13</span>,<span class="number">27</span>,<span class="number">180</span>,<span class="number">16</span>,<span class="number">43</span>,<span class="number">82</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">76</span>,<span class="number">28</span>,<span class="number">66</span>,<span class="number">29</span>,<span class="number">14</span>,<span class="number">14</span>,<span class="number">65</span>,<span class="number">37</span>,<span class="number">16</span>,<span class="number">37</span>,<span class="number">35</span>,<span class="number">39</span>,<span class="number">27</span>,<span class="number">14</span>,<span class="number">17</span>,<span class="number">13</span>,<span class="number">38</span>,<span class="number">28</span>,<span class="number">40</span>,<span class="number">85</span>,<span class="number">32</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">16</span>,<span class="number">12</span>,<span class="number">54</span>,<span class="number">40</span>,<span class="number">18</span>,<span class="number">27</span>,<span class="number">16</span>,<span class="number">14</span>,<span class="number">33</span>,<span class="number">29</span>,<span class="number">77</span>,<span class="number">50</span>,<span class="number">19</span>,<span class="number">34</span>)</div><div class="line"><span class="number">3</span> par(mfrow=c(<span class="number">2</span>,<span class="number">2</span>))#将绘图窗口改成<span class="number">2</span>*<span class="number">2</span>，可同时显示四幅图</div><div class="line"><span class="number">4</span> hist(pay)#绘制直方图</div><div class="line"><span class="number">5</span> dotchart(pay)#绘制点图</div><div class="line"><span class="number">6</span> barplot(pay,horizontal=T)#绘制箱型图<span class="number">7</span> qqnorm(pay);qqline(pay)#绘制Q-Q图</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/325148-b3594976d85426b4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>　　从上面四幅图可以很清楚的看出，180是异常值，即第23个数据需要清理。</p>
<p>　　python中也包含了大量的统计命令，其中主要的统计特征函数如下图所示：<br><img src="http://upload-images.jianshu.io/upload_images/325148-1f0ac1838dd1ea5d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>二.缺失值处理</strong><br>　　缺失值在实际数据中是不可避免的问题，有的人看到有缺失的数据就直接删除了，有的人直接赋予0值或者某一个特殊的值，那么到底该怎么处理呢？对于不同的数据场景应该采取不同的策略，首先应该判断缺失值的分布情况：<br><figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">1 </span>import scipy as sp2 <span class="keyword">data</span> = sp.genfromtxt(<span class="string">"web_traffic.tsv"</span>,delimiter = <span class="string">"\t"</span>)</div></pre></td></tr></table></figure></p>
<p>数据情况如下：<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> &gt;&gt;&gt;data </div><div class="line"><span class="number">2</span> array([[ <span class="number">1</span>.<span class="number">00000000</span>e+<span class="number">00</span>, <span class="number">2</span>.<span class="number">27200000</span>e+<span class="number">03</span>], </div><div class="line"><span class="number">3</span> [ <span class="number">2</span>.<span class="number">00000000</span>e+<span class="number">00</span>, nan], </div><div class="line"><span class="number">4</span> [ <span class="number">3</span>.<span class="number">00000000</span>e+<span class="number">00</span>, <span class="number">1</span>.<span class="number">38600000</span>e+<span class="number">03</span>], </div><div class="line"><span class="number">5</span>  ..., </div><div class="line"><span class="number">6</span> [ <span class="number">7</span>.<span class="number">41000000</span>e+<span class="number">02</span>, <span class="number">5</span>.<span class="number">39200000</span>e+<span class="number">03</span>], </div><div class="line"><span class="number">7</span> [ <span class="number">7</span>.<span class="number">42000000</span>e+<span class="number">02</span>, <span class="number">5</span>.<span class="number">90600000</span>e+<span class="number">03</span>], </div><div class="line"><span class="number">8</span> [ <span class="number">7</span>.<span class="number">43000000</span>e+<span class="number">02</span>, <span class="number">4</span>.<span class="number">88100000</span>e+<span class="number">03</span>]]) </div><div class="line"><span class="number">9</span> </div><div class="line"><span class="number">10</span> &gt;&gt;&gt; print data[:<span class="number">10</span>]</div><div class="line"><span class="number">11</span> [[ <span class="number">1</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">2</span>.<span class="number">27200000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">12</span> [ <span class="number">2</span>.<span class="number">00000000</span>e+<span class="number">00</span> nan]</div><div class="line"><span class="number">13</span> [ <span class="number">3</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">38600000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">14</span> [ <span class="number">4</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">36500000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">15</span> [ <span class="number">5</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">48800000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">16</span> [ <span class="number">6</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">33700000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">17</span> [ <span class="number">7</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">88300000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">18</span> [ <span class="number">8</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">2</span>.<span class="number">28300000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">19</span> [ <span class="number">9</span>.<span class="number">00000000</span>e+<span class="number">00</span> <span class="number">1</span>.<span class="number">33500000</span>e+<span class="number">03</span>]</div><div class="line"><span class="number">20</span> [ <span class="number">1</span>.<span class="number">00000000</span>e+<span class="number">01</span> <span class="number">1</span>.<span class="number">02500000</span>e+<span class="number">03</span>]]</div><div class="line"><span class="number">21</span></div><div class="line"> <span class="number">22</span> &gt;&gt;&gt; data.shape23 (<span class="number">743</span>, <span class="number">2</span>)</div></pre></td></tr></table></figure></p>
<p> 可以看到，第2列已经出现了缺失值，现在我们来看一下缺失值的数量：<br> <figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">1 </span>&gt;&gt;&gt; x = <span class="keyword">data</span>[:,<span class="number">0</span>]</div><div class="line"><span class="symbol">2 </span>&gt;&gt;&gt; y = <span class="keyword">data</span>[:,<span class="number">1</span>]</div><div class="line"><span class="symbol">3 </span>&gt;&gt;&gt; sp.sum(sp.isnan(y))</div><div class="line"><span class="symbol">4 </span><span class="number">8</span></div></pre></td></tr></table></figure></p>
<p> 　　在743个数据里只有8个数据缺失，所以删除它们对于整体数据情况影响不大。当然，这是缺失值少的情况下，在缺失值值比较多，而这个维度的信息还很重要的时候（因为缺失值如果占了95%以上，可以直接去掉这个维度的数据了），直接删除会对后面的算法跑的结果造成不好的影响。我们常用的方法有以下几种：<br> 1.直接删除—-适合缺失值数量较小，并且是随机出现的，删除它们对整体数据影响不大的情况<br> 2.使用一个全局常量填充—譬如将缺失值用“Unknown”等填充，但是效果不一定好，因为算法可能会把它识别为一个新的类别，一般很少用<br> 3.使用均值或中位数代替—-优点：不会减少样本信息，处理简单。缺点：当缺失数据不是随机数据时会产生偏差.对于正常分布的数据可以使用均值代替，如果数据是倾斜的，使用中位数可能更好。<br> 4.插补法<br> 　　1）随机插补法—-从总体中随机抽取某个样本代替缺失样本<br> 　　2）多重插补法—-通过变量之间的关系对缺失数据进行预测，利用蒙特卡洛方法生成多个完整的数据集，在对这些数据集进行分析，最后对分析结果进行汇总处理<br> 　　3）热平台插补—-指在非缺失数据集中找到一个与缺失值所在样本相似的样本（匹配样本），利用其中的观测值对缺失值进行插补。<br> 　　　　优点：简单易行，准去率较高<br> 　　　　缺点：变量数量较多时，通常很难找到与需要插补样本完全相同的样本。但我们可以按照某些变量将数据分层，在层中对缺失值实用均值插补<br> 　　4)拉格朗日差值法和牛顿插值法（简单高效，数值分析里的内容，数学公式以后再补 = =）</p>
<p> 5.建模法<br> 可以用回归、使用贝叶斯形式化方法的基于推理的工具或决策树归纳确定。例如，利用数据集中其他数据的属性，可以构造一棵判定树，来预测缺失值的值。</p>
<p> 　　以上方法各有优缺点，具体情况要根据实际数据分分布情况、倾斜程度、缺失值所占比例等等来选择方法。一般而言，建模法是比较常用的方法，它根据已有的值来预测缺失值，准确率更高。</p>
<p> <strong>三.异常值处理</strong><br> 　　异常值我们通常也称为“离群点”。在讲分析数据时，我们举了个例子说明如何发现离群点，除了画图（画图其实并不常用，因为数据量多时不好画图，而且慢），还有很多其他方法:</p>
<p> 1.简单的统计分析<br> 　　拿到数据后可以对数据进行一个简单的描述性统计分析，譬如最大最小值可以用来判断这个变量的取值是否超过了合理的范围，如客户的年龄为-20岁或200岁，显然是不合常理的，为异常值。<br> 在python中可以直接用pandas的describe()：<br> <figure class="highlight basic"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">1 </span>&gt;&gt;&gt; import pandas as pd </div><div class="line"><span class="symbol">2 </span>&gt;&gt;&gt; <span class="keyword">data</span> = pd.read_table(<span class="string">"web_traffic.tsv"</span>,header = None) </div><div class="line"><span class="symbol">3 </span>&gt;&gt;&gt; <span class="keyword">data</span>.describe() </div><div class="line"><span class="symbol">4 </span><span class="number">0</span> <span class="number">1</span> </div><div class="line"><span class="symbol">5 </span>count <span class="number">743.000000</span> <span class="number">735.000000</span> </div><div class="line"><span class="symbol">6 </span>mean <span class="number">372.000000</span> <span class="number">1962.165986</span> </div><div class="line"><span class="symbol">7 </span>std <span class="number">214.629914</span> <span class="number">860.720997</span> </div><div class="line"><span class="symbol">8 </span>min <span class="number">1.000000</span> <span class="number">472.000000</span> </div><div class="line"><span class="symbol">9 </span><span class="number">25</span>% <span class="number">186.500000</span> <span class="number">1391.00000010</span> <span class="number">50</span>% <span class="number">372.000000</span> <span class="number">1764.00000011</span> <span class="number">75</span>% <span class="number">557.500000</span> <span class="number">2217.50000012</span> max <span class="number">743.000000</span> <span class="number">5906.000000</span></div></pre></td></tr></table></figure></p>
<p>  2.3∂原则<br>  　　如果数据服从正态分布，在3∂原则下，异常值为一组测定值中与平均值的偏差超过3倍标准差的值。如果数据服从正态分布，距离平均值3∂之外的值出现的概率为P(|x-u| &gt; 3∂) &lt;= 0.003，属于极个别的小概率事件。如果数据不服从正态分布，也可以用远离平均值的多少倍标准差来描述。</p>
<p>  3.箱型图分析<br>  　　箱型图提供了识别异常值的一个标准：如果一个值小于QL01.5IQR或大于OU-1.5IQR的值，则被称为异常值。QL为下四分位数，表示全部观察值中有四分之一的数据取值比它小；QU为上四分位数，表示全部观察值中有四分之一的数据取值比它大；IQR为四分位数间距，是上四分位数QU与下四分位数QL的差值，包含了全部观察值的一半。箱型图判断异常值的方法以四分位数和四分位距为基础，四分位数具有鲁棒性：25%的数据可以变得任意远并且不会干扰四分位数，所以异常值不能对这个标准施加影响。因此箱型图识别异常值比较客观，在识别异常值时有一定的优越性。</p>
<p>  4.基于模型检测<br>  　　首先建立一个数据模型，异常是那些同模型不能完美拟合的对象；如果模型是簇的集合，则异常是不显著属于任何簇的对象；在使用回归模型时，异常是相对远离预测值的对象<br>  优缺点：1.有坚实的统计学理论基础，当存在充分的数据和所用的检验类型的知识时，这些检验可能非常有效；2.对于多元数据，可用的选择少一些，并且对于高维数据，这些检测可能性很差。</p>
<p>  5.基于距离<br>  　　通常可以在对象之间定义邻近性度量，异常对象是那些远离其他对象的对象<br>  优缺点：1.简单；2.缺点：基于邻近度的方法需要O(m2)时间，大数据集不适用；3.该方法对参数的选择也是敏感的；4.不能处理具有不同密度区域的数据集，因为它使用全局阈值，不能考虑这种密度的变化。</p>
<p>  6.基于密度<br>  　　当一个点的局部密度显著低于它的大部分近邻时才将其分类为离群点。适合非均匀分布的数据。<br>  优缺点：1.给出了对象是离群点的定量度量，并且即使数据具有不同的区域也能够很好的处理；2.与基于距离的方法一样，这些方法必然具有O(m2)的时间复杂度。对于低维数据使用特定的数据结构可以达到O(mlogm)；3.参数选择困难。虽然算法通过观察不同的k值，取得最大离群点得分来处理该问题，但是，仍然需要选择这些值的上下界。</p>
<p>  7.基于聚类：<br>  　　基于聚类的离群点：一个对象是基于聚类的离群点，如果该对象不强属于任何簇。离群点对初始聚类的影响：如果通过聚类检测离群点，则由于离群点影响聚类，存在一个问题：结构是否有效。为了处理该问题，可以使用如下方法：对象聚类，删除离群点，对象再次聚类（这个不能保证产生最优结果）。<br>  优缺点：1.基于线性和接近线性复杂度（k均值）的聚类技术来发现离群点可能是高度有效的；2.簇的定义通常是离群点的补，因此可能同时发现簇和离群点；3.产生的离群点集和它们的得分可能非常依赖所用的簇的个数和数据中离群点的存在性；4.聚类算法产生的簇的质量对该算法产生的离群点的质量影响非常大。</p>
<p>  <strong>处理方法：</strong><br>  1.删除异常值—-明显看出是异常且数量较少可以直接删除<br>  2.不处理—如果算法对异常值不敏感则可以不处理，但如果算法对异常值敏感，则最好不要用，如基于距离计算的一些算法，包括kmeans，knn之类的。<br>  3.平均值替代—-损失信息小，简单高效。<br>  4.视为缺失值—-可以按照处理缺失值的方法来处理</p>
<p>  <strong>四.去重处理</strong><br>  以DataFrame数据格式为例：<br>  <figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">1 <span class="comment">#创建数据，data里包含重复数据</span></div><div class="line"><span class="number"> 2 </span>&gt;&gt;&gt; data = pd.DataFrame(&#123;'v1':['a']*5+['b']* 4,'v2':[1,2,2,2,3,4,4,5,3]&#125;) </div><div class="line"><span class="number"> 3 </span>&gt;&gt;&gt; data </div><div class="line"><span class="number"> 4 </span> v1 v2 </div><div class="line"><span class="number"> 5 </span>0 a<span class="number"> 1 </span></div><div class="line"><span class="number"> 6 </span>1 a<span class="number"> 2 </span></div><div class="line"><span class="number"> 7 </span>2 a<span class="number"> 2 </span></div><div class="line"><span class="number"> 8 </span>3 a<span class="number"> 2 </span></div><div class="line"><span class="number"> 9 </span>4 a 3</div><div class="line"><span class="number"> 10 </span>5 b 4</div><div class="line"><span class="number"> 11 </span>6 b 4</div><div class="line"><span class="number"> 12 </span>7 b 5</div><div class="line"><span class="number"> 13 </span>8 b 3</div><div class="line"><span class="number"> 14 </span></div><div class="line"><span class="number"> 15 </span><span class="comment">#DataFrame的duplicated方法返回一个布尔型Series，表示各行是否是重复行</span></div><div class="line"><span class="number"> 16 </span>&gt;&gt;&gt; data.duplicated()</div><div class="line"><span class="number"> 17 </span>0 False</div><div class="line"><span class="number"> 18 </span>1 False</div><div class="line"><span class="number"> 19 </span>2 True</div><div class="line"><span class="number"> 20 </span>3 True</div><div class="line"><span class="number"> 21 </span>4 False</div><div class="line"><span class="number"> 22 </span>5 False</div><div class="line"><span class="number"> 23 </span>6 True</div><div class="line"><span class="number"> 24 </span>7 False</div><div class="line"><span class="number"> 25 </span>8 False</div><div class="line"><span class="number"> 26 </span>dtype: bool</div><div class="line"><span class="number"> 27 </span></div><div class="line"><span class="number"> 28 </span><span class="comment">#drop_duplicates方法用于返回一个移除了重复行的DataFrame</span></div><div class="line"><span class="number"> 29 </span>&gt;&gt;&gt; data.drop_duplicates()</div><div class="line"><span class="number"> 30 </span> v1 v2</div><div class="line"><span class="number"> 31 </span>0 a 1</div><div class="line"><span class="number"> 32 </span>1 a 2</div><div class="line"><span class="number"> 33 </span>4 a 3</div><div class="line"><span class="number"> 34 </span>5 b 4</div><div class="line"><span class="number"> 35 </span>7 b 5</div><div class="line"><span class="number"> 36 </span>8 b 3</div><div class="line"><span class="number"> 37 </span></div><div class="line"><span class="number"> 38 </span><span class="comment">#这两个方法默认会判断全部列，你也可以指定部分列进行重复项判断。假设你还有一列值，且只希望根据v1列过滤重复项：</span></div><div class="line"><span class="number"> 39 </span>&gt;&gt;&gt; data['v3']=range(9)</div><div class="line"><span class="number"> 40 </span>&gt;&gt;&gt; data</div><div class="line"><span class="number"> 41 </span> v1 v2 v3</div><div class="line"><span class="number"> 42 </span>0 a<span class="number"> 1 </span>0</div><div class="line"><span class="number"> 43 </span>1 a<span class="number"> 2 </span>1</div><div class="line"><span class="number"> 44 </span>2 a<span class="number"> 2 </span>2</div><div class="line"><span class="number"> 45 </span>3 a<span class="number"> 2 </span>3</div><div class="line"><span class="number"> 46 </span>4 a<span class="number"> 3 </span>4</div><div class="line"><span class="number"> 47 </span>5 b<span class="number"> 4 </span>5</div><div class="line"><span class="number"> 48 </span>6 b<span class="number"> 4 </span>6</div><div class="line"><span class="number"> 49 </span>7 b<span class="number"> 5 </span>7</div><div class="line"><span class="number"> 50 </span>8 b<span class="number"> 3 </span>8</div><div class="line"><span class="number"> 51 </span>&gt;&gt;&gt; data.drop_duplicates(['v1'])</div><div class="line"><span class="number"> 52 </span> v1 v2 v3</div><div class="line"><span class="number"> 53 </span>0 a<span class="number"> 1 </span>0</div><div class="line"><span class="number"> 54 </span>5 b<span class="number"> 4 </span>5</div><div class="line"><span class="number"> 55 </span></div><div class="line"><span class="number"> 56 </span><span class="comment">#duplicated和drop_duplicates默认保留的是第一个出现的值组合。传入take_last=True则保留最后一个：</span></div><div class="line"><span class="number"> 57 </span>&gt;&gt;&gt; data.drop_duplicates(['v1','v2'],take_last = True)</div><div class="line"><span class="number"> 58 </span> v1 v2 v3</div><div class="line"><span class="number"> 59 </span>0 a<span class="number"> 1 </span>0</div><div class="line"><span class="number"> 60 </span>3 a<span class="number"> 2 </span>3</div><div class="line"><span class="number"> 61 </span>4 a<span class="number"> 3 </span>4</div><div class="line"><span class="number"> 62 </span>6 b<span class="number"> 4 </span>6</div><div class="line"><span class="number"> 63 </span>7 b<span class="number"> 5 </span>7</div><div class="line"><span class="number"> 64 </span>8 b<span class="number"> 3 </span>8</div></pre></td></tr></table></figure></p>
<pre><code>如果数据是列表格式的，有以下几种方法可以删除：
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> list0=[<span class="string">'b'</span>,<span class="string">'c'</span>, <span class="string">'d'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'a'</span>,<span class="string">'a'</span>] </div><div class="line"><span class="number">2</span>  </div><div class="line"><span class="number">3</span> 方法<span class="number">1</span>：使用set() </div><div class="line"><span class="number">4</span>  </div><div class="line"><span class="number">5</span> list1=sorted(set(list0),key=list0.index) <span class="comment"># sorted output </span></div><div class="line"><span class="number">6</span> print( list1) </div><div class="line"><span class="number">7</span>  </div><div class="line"><span class="number">8</span> 方法<span class="number">2</span>：使用 &#123;&#125;.fromkeys().keys() </div><div class="line"><span class="number">9</span> </div><div class="line"><span class="number">10</span> list2=&#123;&#125;.fromkeys(list0).keys()</div><div class="line"><span class="number">11</span> print(list2)</div><div class="line"><span class="number">12</span> </div><div class="line"><span class="number">13</span> 方法<span class="number">3</span>：set()+sort()</div><div class="line"><span class="number">14</span> </div><div class="line"><span class="number">15</span> list3=list(set(list0))</div><div class="line"><span class="number">16</span> list3.sort(key=list0.index)</div><div class="line"><span class="number">17</span> print(list3)</div><div class="line"><span class="number">18</span> </div><div class="line"><span class="number">19</span> 方法<span class="number">4</span>：迭代</div><div class="line"><span class="number">20</span> </div><div class="line"><span class="number">21</span> list4=[]</div><div class="line"><span class="number">22</span> <span class="keyword">for</span> i <span class="keyword">in</span> list0:</div><div class="line"><span class="number">23</span> <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">in</span> list4:</div><div class="line"><span class="number">24</span>  list4.append(i)</div><div class="line"><span class="number">25</span> print(list4)</div><div class="line"><span class="number">26</span> </div><div class="line"><span class="number">27</span> 方法<span class="number">5</span>：排序后比较相邻<span class="number">2</span>个元素的数据，重复的删除</div><div class="line"><span class="number">28</span> </div><div class="line"><span class="number">29</span> <span class="function"><span class="keyword">def</span> <span class="title">sortlist</span><span class="params">(list0)</span>:</span></div><div class="line"><span class="number">30</span>  list0.sort()</div><div class="line"><span class="number">31</span> last=list0[<span class="number">-1</span>]</div><div class="line"><span class="number">32</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(list0)<span class="number">-2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</div><div class="line"><span class="number">33</span> <span class="keyword">if</span> list0[i]==last:</div><div class="line"><span class="number">34</span>  list0.remove(list0[i])</div><div class="line"><span class="number">35</span> <span class="keyword">else</span>:</div><div class="line"><span class="number">36</span> last=list0[i]</div><div class="line"><span class="number">37</span> <span class="keyword">return</span> list0</div><div class="line"><span class="number">38</span> </div><div class="line"><span class="number">39</span> print(sortlist(list0))</div></pre></td></tr></table></figure>


 ** 五.噪音处理**
 　  噪音，是被测量变量的随机误差或方差。我们在上文中提到过异常点（离群点），那么离群点和噪音是不是一回事呢？我们知道，观测量(Measurement) = 真实数据(True Data) + 噪声 (Noise)。离群点(Outlier)属于观测量，既有可能是真实数据产生的，也有可能是噪声带来的，但是总的来说是和大部分观测量之间有明显不同的观测值。。噪音包括错误值或偏离期望的孤立点值，但也不能说噪声点包含离群点，虽然大部分数据挖掘方法都将离群点视为噪声或异常而丢弃。然而，在一些应用（例如：欺诈检测），会针对离群点做离群点分析或异常挖掘。而且有些点在局部是属于离群点，但从全局看是正常的。
 　　我在quora上看到过一个解释噪音与离群点的有趣的例子：
 Outlier: you are enumerating meticulously everything you have. You found 3 dimes, 1 quarter and wow a 100 USD bill you had put there last time you bought some booze and had totally forgot there. The 100 USD bill is an outlier, as it&apos;s not commonly expected in a pocket.Noise: you have just come back from that club and are pretty much wasted. You try to find some money to buy something to sober up, but you have trouble reading the figures correctly on the coins. You found 3 dimes, 1 quarter and wow a 100 USD bill. But in fact, you have mistaken the quarter for a dime: this mistake introduces noise in the data you have access to.To put it otherwise, data = true signal + noise. Outliers are part of the data.

 翻译过来就是：
 离群点： 你正在从口袋的零钱包里面穷举里面的钱，你发现了3个一角，1个五毛，和一张100元的毛爷爷向你微笑。这个100元就是个离群点，因为并不应该常出现在口袋里..噪声： 你晚上去三里屯喝的酩酊大醉，很需要买点东西清醒清醒，这时候你开始翻口袋的零钱包，嘛，你发现了3个一角，1个五毛，和一张100元的毛爷爷向你微笑。但是你突然眼晕，把那三个一角看成了三个1元...这样错误的判断使得数据集中出现了噪声


 　　那么对于噪音我们应该如何处理呢？有以下几种方法：
 **1.分箱法**
 分箱方法通过考察数据的“近邻”（即，周围的值）来光滑有序数据值。这些有序的值被分布到一些“桶”或箱中。由于分箱方法考察近邻的值，因此它进行局部光滑。
 用箱均值光滑：箱中每一个值被箱中的平均值替换。
 用箱中位数平滑：箱中的每一个值被箱中的中位数替换。
 用箱边界平滑：箱中的最大和最小值同样被视为边界。箱中的每一个值被最近的边界值替换。

 一般而言，宽度越大，光滑效果越明显。箱也可以是等宽的，其中每个箱值的区间范围是个常量。分箱也可以作为一种离散化技术使用.
 **2.  回归法**
 　　可以用一个函数拟合数据来光滑数据。线性回归涉及找出拟合两个属性（或变量）的“最佳”直线，使得一个属性能够预测另一个。多线性回归是线性回归的扩展，它涉及多于两个属性，并且数据拟合到一个多维面。使用回归，找出适合数据的数学方程式，能够帮助消除噪声。


 **六.一些实用的数据处理小工具**
 1.**去掉文件中多余的空行**
 空行主要指的是（\n,\r,\r\n,\n\r等），在python中有个strip()的方法，该方法可以去掉字符串两端多余的“空白”，此处的空白主要包括空格，制表符(\t)，换行符。不过亲测以后发现，strip()可以匹配掉\n,\r\n,\n\r等，但是过滤不掉单独的\r。为了万无一失，我还是喜欢用麻烦的办法，如下：
 <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> #-*- coding :utf-<span class="number">8</span> -*-  <span class="number">2</span> #文本格式化处理，过滤掉空行 <span class="number">3</span>  <span class="number">4</span> <span class="keyword">file</span> = <span class="keyword">open</span>(<span class="string">'123.txt'</span>) <span class="number">5</span>  <span class="number">6</span> i = <span class="number">0</span> <span class="number">7</span> <span class="keyword">while</span> <span class="number">1</span>: <span class="number">8</span> <span class="built_in">line</span> = <span class="keyword">file</span>.readline().strip() <span class="number">9</span> <span class="keyword">if</span> not <span class="built_in">line</span>:<span class="number">10</span> break11 i = i + <span class="number">112</span> line1 = <span class="built_in">line</span>.replace(<span class="string">'\r'</span>,<span class="string">''</span>)<span class="number">13</span> f1 = <span class="keyword">open</span>(<span class="string">'filename.txt'</span>,<span class="string">'a'</span>)<span class="number">14</span> f1.<span class="keyword">write</span>(line1 + <span class="string">'\n'</span>)<span class="number">15</span>  f1.<span class="keyword">close</span>()<span class="number">16</span> <span class="keyword">print</span> str(i)</div></pre></td></tr></table></figure>



  2.**如何判断文件的编码格式**
  <figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> #-*- coding:utf8 -*- <span class="number">2</span> #批量处理编码格式转换（优化） <span class="number">3</span> <span class="keyword">import</span> os <span class="number">4</span> <span class="keyword">import</span> chardet <span class="number">5</span>  <span class="number">6</span> path1 = <span class="string">'E://2016txtutf/'</span> <span class="number">7</span> def dirlist(path): <span class="number">8</span> filelist = os.listdir(path) <span class="number">9</span> <span class="keyword">for</span> filename <span class="keyword">in</span> filelist:<span class="number">10</span> filepath = os.path.join(path, filename)<span class="number">11</span> <span class="keyword">if</span> os.path.isdir(filepath):<span class="number">12</span>  dirlist(filepath)<span class="number">13</span> <span class="keyword">else</span>:<span class="number">14</span> <span class="keyword">if</span> filepath.endswith(<span class="string">'.txt'</span>):<span class="number">15</span> f = <span class="keyword">open</span>(filepath)<span class="number">16</span> <span class="keyword">data</span> = f.read()<span class="number">17</span> <span class="keyword">if</span> chardet.detect(<span class="keyword">data</span>)[<span class="string">'encoding'</span>] != <span class="string">'utf-8'</span>:<span class="number">18</span> print filepath + <span class="string">"----"</span>+ chardet.detect(<span class="keyword">data</span>)[<span class="string">'encoding'</span>]<span class="number">19</span> <span class="number">20</span> dirlist(path1)</div></pre></td></tr></table></figure>


   3.**文件编码格式转换，gbk与utf-8之间的转换**
   这个主要是在一些对文件编码格式有特殊需求的时候，需要批量将gbk的转utf-8的或者将utf-8编码的文件转成gbk编码格式的。
   <figure class="highlight tcl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> #-*- coding:gbk -*-  <span class="number">2</span> #批量处理编码格式转换 <span class="number">3</span> import codecs <span class="number">4</span> import os <span class="number">5</span> path1 = <span class="string">'E://dir/'</span> <span class="number">6</span> def ReadFile(filePath,<span class="keyword">encoding</span>=<span class="string">"utf-8"</span>): <span class="number">7</span> with codecs.<span class="keyword">open</span>(filePath,<span class="string">"r"</span>,<span class="keyword">encoding</span>) as f: <span class="number">8</span> <span class="keyword">return</span> f.<span class="keyword">read</span>() <span class="number">9</span> <span class="number">10</span> def WriteFile(filePath,u,<span class="keyword">encoding</span>=<span class="string">"gbk"</span>):<span class="number">11</span> with codecs.<span class="keyword">open</span>(filePath,<span class="string">"w"</span>,<span class="keyword">encoding</span>) as f:<span class="number">12</span>  f.write(u)<span class="number">13</span> <span class="number">14</span> def UTF8_2_GBK(src,dst):<span class="number">15</span> content = ReadFile(src,<span class="keyword">encoding</span>=<span class="string">"utf-8"</span>)<span class="number">16</span> WriteFile(dst,content,<span class="keyword">encoding</span>=<span class="string">"gbk"</span>)<span class="number">17</span> <span class="number">18</span> def GBK_2_UTF8(src,dst):<span class="number">19</span> content = ReadFile(src,<span class="keyword">encoding</span>=<span class="string">"gbk"</span>)<span class="number">20</span> WriteFile(dst,content,<span class="keyword">encoding</span>=<span class="string">"utf-8"</span>)<span class="number">21</span> <span class="number">22</span> def dirlist(path):<span class="number">23</span> filelist = os.listdir(path)<span class="number">24</span> <span class="keyword">for</span> <span class="keyword">filename</span> in filelist:<span class="number">25</span> filepath = os.path.<span class="keyword">join</span>(path, <span class="keyword">filename</span>)<span class="number">26</span> <span class="keyword">if</span> os.path.isdir(filepath):<span class="number">27</span>  dirlist(filepath)<span class="number">28</span> else:<span class="number">29</span> <span class="keyword">if</span> filepath.endswith(<span class="string">'.txt'</span>):<span class="number">30</span> print filepath31 #os.<span class="keyword">rename</span>(filepath, filepath.replace(<span class="string">'.txt'</span>,<span class="string">'.doc'</span>))<span class="number">32</span> try:<span class="number">33</span>  UTF8_2_GBK(filepath,filepath)<span class="number">34</span> except Exception,ex:<span class="number">35</span> f = <span class="keyword">open</span>(<span class="string">'error.txt'</span>,<span class="string">'a'</span>)<span class="number">36</span> f.write(filepath + <span class="string">'\n'</span>)<span class="number">37</span>  f.<span class="keyword">close</span>()<span class="number">38</span> <span class="number">39</span> dirlist(path1)</div></pre></td></tr></table></figure>





参考文献：
1.http://blog.csdn.net/u012950655/article/details/16946021
2.http://my.oschina.net/dfsj66011/blog/601546
3.http://www.cnblogs.com/nzyjlr/p/4174145.html
4.https://www.quora.com/What-is-the-basic-difference-between-noise-and-outliers-in-Data-mining
6.《数据挖掘：概念与技术》，Jiawei Han Micheline Kamber Jian Pei
</code></pre>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/03/15/数据挖掘系列（一）数据清洗/">数据挖掘系列（一）数据清洗</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 Huimm 的个人博客">Huimm</a></p>
        <p><span>发布时间:</span>2017年03月15日 - 10时34分</p>
        <p><span>最后更新:</span>2017年03月15日 - 11时05分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/03/15/数据挖掘系列（一）数据清洗/" title="数据挖掘系列（一）数据清洗">http://blog.huimm.top/2017/03/15/数据挖掘系列（一）数据清洗/</a>
            <span class="copy-path" data-clipboard-text="原文: http://blog.huimm.top/2017/03/15/数据挖掘系列（一）数据清洗/　　作者: Huimm" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
  
    <a href="/2016/11/25/dataMining初步/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">dataMining初步</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2017/03/15/数据挖掘系列（一）数据清洗/" data-title="数据挖掘系列（一）数据清洗" data-url="http://blog.huimm.top/2017/03/15/数据挖掘系列（一）数据清洗/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"null"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2016/11/25/dataMining初步/" title="下一篇: dataMining初步">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/数据挖掘系列（一）数据清洗/">数据挖掘系列（一）数据清洗</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/25/dataMining初步/">dataMining初步</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/17/推荐系统/">推荐系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/11/Apriori/">数据挖掘之Apriori算法详解和Python实现代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/30/README/">Awesome Python Books(in English)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/30/README-ZH_CN/">python资料</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/29/技能/">技能</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/29/markdown/">markdown</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 Huimm
            </div>
            <div class="footer-right">
                <a href="https://github.com/huihui7987/" target="_blank">Huimm</a>  github <a href="https://github.com/huihui7987/" target="_blank"></a> by huihui
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>